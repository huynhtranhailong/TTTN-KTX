function activeTab(t){$('.nav-tabs a[href="#'+t+'"]').tab("show")}function editDate(t,e,n,o,i){$.confirm({columnClass:"col-md-5 col-md-offset-4 col-xs-8 col-xs-offset-4",title:"ĐIỀU CHỈNH THÔNG TIN CHO HỌC KỲ ",content:"<p> Đang điều chỉnh thông tin cho học kỳ "+i+" năm học "+o+"-"+(parseInt(o)+1).toString()+'</p><form action="/admin/semester/updateDate" method="post" class="updateDate"><div class="col-md-6"><div class="form-group"><b>Thời gian bắt đầu</b><div class="form-line"><input class="form-control date" type="text" placeholder="DD/MM/YYYY" name="semester[startDate]" value="'+e+'"/></div></div></div><div class="col-md-6"><div class="form-group"><b>Thời gian kết thúc</b><div class="form-line"><input class="form-control date" type="text" placeholder="DD/MM/YYYY" name="semester[endDate]" value="'+n+'"/><input name="id" type="text" class="hidden" value="'+t+'"/><input name="semester[year]" type="text" class="hidden" value="'+o+'"/><input name="semester[value]" type="text" class="hidden" value="'+i+'"/></div></div></div></form>',buttons:{formSubmit:{text:"ĐỒNG Ý",btnClass:"btn-blue",action:function(){$(".updateDate")[0].submit()}},cancel:{text:"HỦY"}},onContentReady:function(){$(".date").inputmask("dd/mm/yyyy",{placeholder:"__/__/____"});var t=this;this.$content.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}})}function addParentMenu(t){$.confirm({columnClass:"col-md-5 col-md-offset-4 col-xs-8 col-xs-offset-4",title:"THÊM MENU CHÍNH",content:'<form class="addMenu" action="/admin/menu/createParent" method="post"><div class="col-md-12"><div class="form-group"><b>Tên menu</b><div class="form-line"><input class="form-control" type="text" name="menu[name]" /></div></div></div><div class="col-md-12"><div class="form-group"><b>Đường dẫn đến bài viết (nếu có)</b>'+selectNews+'<input class="form-control hidden" type="text"  name="configId" value="'+t+'"/></div></div></div></form>',buttons:{formSubmit:{text:"THÊM",btnClass:"btn-blue",action:function(){$(".addMenu")[0].submit()}},cancel:{text:"HỦY"}},onContentReady:function(){$(".selectNews").select2({placeholder:{id:"-1",text:"Chọn bài viết"},allowClear:!0})}})}function editParentMenu(t,e,n,o){var i='<select class="form-control selectNews" name="menu[link]" ><option></option>';news.map(function(t){var e="/tin-tuc/"+new Date(t.created).getTime();i+=e==o?'<option value="'+e+'" selected>'+t.title.tonal+"</option>":'<option value="'+e+'">'+t.title.tonal+"</option>"}),i+="</select>",$.confirm({columnClass:"col-md-5 col-md-offset-4 col-xs-8 col-xs-offset-4",title:"CHỈNH SỬA MENU CHÍNH",content:'<form class="editParentMenu" action="/admin/menu/editParent" method="post"><div class="col-md-12"><div class="form-group"><b>Tên menu</b><div class="form-line"><input class="form-control" type="text" name="menu[name]" value="'+n+'" /></div></div></div><div class="col-md-12"><div class="form-group"><b>Đường dẫn đến bài viết (nếu có)</b>'+i+'<input class="form-control hidden" type="text"  name="configId" value="'+t+'"/><input class="form-control hidden" type="text"  name="menuId" value="'+e+'"/></div></div></div></form>',buttons:{formSubmit:{text:"CHỈNH SỬA",btnClass:"btn-blue",action:function(){$(".editParentMenu")[0].submit()}},cancel:{text:"HỦY"}},onContentReady:function(){$(".selectNews").select2({placeholder:{id:"-1",text:"Chọn bài viết"},allowClear:!0})}})}function addChildrenMenu(t,e){$.confirm({columnClass:"col-md-5 col-md-offset-4 col-xs-8 col-xs-offset-4",title:"THÊM MENU PHỤ",content:'<form class="addChildrenMenu" action="/admin/menu/createChildren" method="post"><div class="col-md-12"><div class="form-group"><b>Tên menu</b><div class="form-line"><input class="form-control" type="text" name="menu[name]" /></div></div></div><div class="col-md-12"><div class="form-group"><b>Đường dẫn đến bài viết (nếu có)</b>'+selectNews+'<input class="form-control hidden" type="text"  name="configId" value="'+t+'"/><input class="form-control hidden" type="text"  name="menuId" value="'+e+'"/></div></div></div></form>',buttons:{formSubmit:{text:"THÊM",btnClass:"btn-blue",action:function(){$(".addChildrenMenu")[0].submit()}},cancel:{text:"HỦY"}},onContentReady:function(){$(".selectNews").select2({placeholder:{id:"-1",text:"Chọn bài viết"},allowClear:!0})}})}function editChildrenMenu(t,e,n,o){var i='<select class="form-control selectNews" name="menu[link]" ><option></option>';news.map(function(t){var e="/tin-tuc/"+new Date(t.created).getTime();i+=e==o?'<option value="'+e+'" selected>'+t.title.tonal+"</option>":'<option value="'+e+'">'+t.title.tonal+"</option>"}),i+="</select>",$.confirm({columnClass:"col-md-5 col-md-offset-4 col-xs-8 col-xs-offset-4",title:"CHỈNH SỬA MENU PHỤ",content:'<form class="editChildrenMenu" action="/admin/menu/editChildren" method="post"><div class="col-md-12"><div class="form-group"><b>Tên menu</b><div class="form-line"><input class="form-control" type="text" name="menu[name]" value="'+n+'" /></div></div></div><div class="col-md-12"><div class="form-group"><b>Đường dẫn đến bài viết (nếu có)</b>'+i+'<input class="form-control hidden" type="text"  name="configId" value="'+t+'"/><input class="form-control hidden" type="text"  name="menuId" value="'+e+'"/></div></div></div></form>',buttons:{formSubmit:{text:"CHỈNH SỬA",btnClass:"btn-blue",action:function(){$(".editChildrenMenu")[0].submit()}},cancel:{text:"HỦY"}},onContentReady:function(){$(".selectNews").select2({placeholder:{id:"-1",text:"Chọn bài viết"},allowClear:!0})}})}function deleteParentMenu(t,e,n){$.confirm({columnClass:"col-md-5 col-md-offset-4 col-xs-8 col-xs-offset-4",title:"XÓA MENU PHỤ",content:'<form class="deleteParentMenu" action="/admin/menu/deleteParent" method="post"><div class="col-md-12"><div class="form-group"><b>Bạn có chắc chắn muốn xóa </b><span class="col-red"> '+n+'</span><input class="form-control hidden" type="text"  name="configId" value="'+t+'"/><input class="form-control hidden" type="text"  name="menuId" value="'+e+'"/></div></div></form>',buttons:{formSubmit:{text:"XÓA",btnClass:"btn-blue",action:function(){$(".deleteParentMenu")[0].submit()}},cancel:{text:"HỦY"}},onContentReady:function(){$(".selectNews").select2({placeholder:{id:"-1",text:"Chọn bài viết"},allowClear:!0})}})}function deleteChildrenMenu(t,e,n){$.confirm({columnClass:"col-md-5 col-md-offset-4 col-xs-8 col-xs-offset-4",title:"XÓA MENU PHỤ",content:'<form class="deleteChildrenMenu" action="/admin/menu/deleteChildren" method="post"><div class="col-md-12"><div class="form-group"><b>Bạn có chắc chắn muốn xóa </b><span class="col-red"> '+n+'</span><input class="form-control hidden" type="text"  name="configId" value="'+t+'"/><input class="form-control hidden" type="text"  name="menuId" value="'+e+'"/></div></div></form>',buttons:{formSubmit:{text:"XÓA",btnClass:"btn-blue",action:function(){$(".deleteChildrenMenu")[0].submit()}},cancel:{text:"HỦY"}},onContentReady:function(){$(".selectNews").select2({placeholder:{id:"-1",text:"Chọn bài viết"},allowClear:!0})}})}function changeCategoriesPublished(t,e){$.confirm({title:"Thay đổi sử dụng chuyên mục!",content:"Bạn có chắc chắn muốn thay đổi không ???",buttons:{confirm:{text:"Có",btnClass:"btn-blue",action:function(){$.get("/admin/categories/changePublished/"+t,function(t){if(1==t.status){$.alert("Thay đổi thành công");var n=$('tr[data-id="'+e+'"]').children().eq(5).children().eq(0);n.hasClass("glyphicon-star")?(n.removeClass("glyphicon-star"),n.addClass("glyphicon-star-empty")):(n.removeClass("glyphicon-star-empty"),n.addClass("glyphicon-star"))}})}},formCancel:{text:"Không"}}})}function changeCategoriesName(t,e,n){$.confirm({title:"ĐỔI TÊN CHUYÊN MỤC ",content:'<form action=""  class="formName"><div class="form-group"><label>Chuyên mục "'+n+'". Bạn có chắc chắn muốn đổi tên chuyên mục này ?</label><input type="text" placeholder="Tên chuyên mục" class="name form-control" required /></div></form>',buttons:{formSubmit:{text:"Có",btnClass:"btn-blue",action:function(){var n=this.$content.find(".name").val();if(!n)return!0;$.post("/admin/categories/changeName/"+e+"/"+n,function(e){1==e.status?($.alert("Đổi tên thành công"),$('tr[data-id="'+t+'"]').children().eq(1).children().eq(0).html(n)):$.alert("Tên bạn đổi đã tồn tại , vui lòng chọn tên khác")})}},formCancel:{text:"Không"}},onContentReady:function(){var t=this;this.$content.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}})}function isPublished(t){var e=$('tr[data-id="'+t+'"]').children().eq(5).children().eq(0).children().eq(0);e.hasClass("glyphicon-star")?(e.removeClass("glyphicon-star"),e.addClass("glyphicon-star-empty")):(e.removeClass("glyphicon-star-empty"),e.addClass("glyphicon-star"))}function editContent(t,e,n){$.confirm({title:"Thay đổi liên kết/quảng cáo!",content:'<form action="" class="formName"><div class="form-group" id="create-link"><input type="text" placeholder="Nội dung liên kết" class="content form-control"value="'+n+'"/><input type="text" placeholder="Đường dẫn" class="link form-control"value="'+e+'"/></div></form>',buttons:{confirm:{btnClass:"btn-blue",text:"Có",action:function(){var e=this.$content.find(".content").val(),n=this.$content.find(".link").val(),o=$('tr[data-id="'+t+'"]');o.children().eq(2).html(n),o.children().eq(3).html(e)}},formCancel:{text:"Không"}}})}function parseDate(t){var e=t.split("/"),n=new Date(e[2],e[1]-1,e[0]);return isNaN(n.getTime())?null:n}function validateAddFloor(){return $("input[name='floorName']").length>0?(alert("Thêm tầng thành công."),!0):(alert("Chưa có tên tầng"),!1)}function showRoomOfFloor(){$("#roomList").empty(),$("#bedList").empty();var t=event.target.value,e=JSON.parse($('input[name="currentConfig"]').val()),n=e.floor.findIndex(function(e){return e._id.toString()==t});if(e.floor[n].roomList.length>0){var o="";e.floor[n].roomList.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(e){var n=e.name;o+='<div class="row clearfix"><button class="form-control" style="box-shadow: none; background-color: #fff; border: none; color: blue; text-align: left"  name="roomList" value="'+t+"-"+e._id+'" onclick="showBedOfRoom()">PHÒNG '+n+'<i class="material-icons" style="vertical-align: sub; font-size: 100%;">chevron_right</i></button></div>'});$("#roomList").append(o)}}function showBedOfRoom(){var t=JSON.parse($('input[name="currentConfig"]').val());$("#bedList").empty();var e=event.target.value.split("-"),n=e[0],o=e[1],i=t.floor.findIndex(function(t){return t._id.toString()==n}),a=t.floor[i].roomList.findIndex(function(t){return t._id.toString()==o});if(t.floor[i].roomList[a].bed.length>0){var l="";t.floor[i].roomList[a].bed.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){var e=t.name;l+='<div class="row clearfix"><button class="form-control" style="box-shadow: none; text-align: left; background-color: #fff; border: none;"  name="roomList" value="'+t._id+'">GIƯỜNG '+e+"</button></div>"});$("#bedList").append(l)}}function validateAddRoom(){return $("input[name='roomName']").val().length<=0?(alert("Tên phòng không được trống."),!1):(alert("Thêm tầng thành công."),!0)}function optionOfSelectRoom(t){var t=t.value,e=JSON.parse($('input[name="currentConfig"]').val()).floor,n=e.findIndex(function(e){return e._id==t}),o='<select class="form-control" name="rooms">';if(0==e[n].roomList.length)o+='<option value=""></option>';else e[n].roomList.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){o+='<option value="'+t._id+'">PHÒNG '+t.name+"</option>"});o+="</select>",$("#selectRoom").empty(),$("#selectRoom").append(o)}function validateRemoveRoom(){return alert("Xoá thành công."),!0}function validateAddBed(){return $("input[name='bedName']").val().length<=0?(alert("Tên giường không được trống."),!1):(alert("Thêm giường thành công."),!0)}function validateRemoveBed(){return alert("Xoá thành công."),!0}function optionOfSelectRoom2(t){var t=t.value,e=JSON.parse($('input[name="currentConfig"]').val()).floor,n=e.findIndex(function(e){return e._id==t}),o='<select class="form-control" name="rooms" onchange="optionOfSelectBed(this)">',i='<select class="form-control" name="beds">';if(0==e[n].roomList.length)o+='<option value=""></option>',i+='<option value=""></option>';else{e[n].roomList.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){o+='<option value="'+t._id+'">PHÒNG '+t.name+"</option>"});if(0==e[n].roomList[0].bed.length)i+='<option value=""></option>';else e[n].roomList[0].bed.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){i+='<option value="'+t._id+'">GIƯỜNG '+t.name+"</option>"})}o+="</select>",i+="</select>",$("#selectRoom").empty(),$("#selectRoom").append(o),$("#selectBed").empty(),$("#selectBed").append(i)}function optionOfSelectBed(t){var e=$('select[name="floors"]').val(),t=t.value,n=JSON.parse($('input[name="currentConfig"]').val()).floor,o=n.findIndex(function(t){return t._id==e}),i='<select class="form-control" name="beds">';if(0==n[o].roomList.length)i+='<option value=""></option>';else{var a=n[o].roomList.findIndex(function(e){return e._id==t});if(0==n[o].roomList[a].bed.length)i+='<option value=""></option>';else n[o].roomList[a].bed.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){i+='<option value="'+t._id+'">GIƯỜNG '+t.name+"</option>"})}i+="</select>",$("#selectBed").empty(),$("#selectBed").append(i)}function changePublishedRoomType(t){$.confirm({title:"Thay đổi sử dụng loại phòng!",content:"Bạn có chắc chắn muốn thay đổi không ???",buttons:{confirm:{text:"Có",btnClass:"btn-blue",action:function(){$.get("/admin/roomType/changePublished/"+t,function(e){if(1==e.status){$.alert("Thay đổi thành công");var n=$('tr[data-id="'+t+'"]').children().eq(4).children().eq(0);n.hasClass("glyphicon-star")?(n.removeClass("glyphicon-star"),n.addClass("glyphicon-star-empty")):(n.removeClass("glyphicon-star-empty"),n.addClass("glyphicon-star"))}})}},formCancel:{text:"Không"}}})}function changeNameRoomType(t,e){$.confirm({title:"ĐỔI TÊN LOẠI PHÒNG ",content:'<form action=""  class="formName"><div class="form-group"><label>Loại phòng "'+e+'". Bạn có chắc chắn muốn đổi tên loại phòng này không ?</label><input type="text" placeholder="Tên loại phòng" class="name form-control" required /></div></form>',buttons:{formSubmit:{text:"Có",btnClass:"btn-blue",action:function(){var e=this.$content.find(".name").val();if(!e)return!0;$.post("/admin/roomType/changeName/"+t+"/"+e,function(n){1==n.status?($.alert("Đổi tên thành công"),$('tr[data-id="'+t+'"]').children().eq(1).html(e)):$.alert("Tên bạn đổi đã tồn tại , vui lòng chọn tên khác")})}},formCancel:{text:"Không"}},onContentReady:function(){var t=this;this.$content.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}})}function showRoom(t,e){var n="";JSON.parse($("#dataFloor").val()).map(function(e){return n="<div>"+n+"<strong>"+e.name+": </strong>",e.roomList.filter(function(e){e.type==t&&(n=n+"<span>"+e.name+", </span>")}),n+="</div>"}),$.alert({btnClass:"btn-blue",title:"DANH SÁCH "+e.toUpperCase(),content:n})}function changeNameRoomType(t,e){$.confirm({title:"ĐỔI TÊN LOẠI PHÒNG ",content:'<form action=""  class="formName"><div class="form-group"><label>Loại phòng "'+e+'". Bạn có chắc chắn muốn đổi tên loại phòng này không ?</label><input type="text" placeholder="Tên loại phòng" class="name form-control" required /></div></form>',buttons:{formSubmit:{text:"Có",btnClass:"btn-blue",action:function(){var n=this.$content.find(".name").val();if(!n)return!0;$.post("/admin/roomType/changeName/"+t+"/"+n+"/"+e,function(e){1==e.status?($.alert("Đổi tên thành công"),$('tr[data-id="'+t+'"]').children().eq(1).html(n)):$.alert("Tên bạn đổi đã tồn tại , vui lòng chọn tên khác")})}},formCancel:{text:"Không"}},onContentReady:function(){var t=this;this.$content.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}})}var selectNews='<select class="form-control selectNews" name="menu[link]" ><option></option>',news;$(document).ready(function(){$.get("/admin/menu/getNews",{},function(t){news=t.news,t.news.map(function(t){var e=new Date(t.created);selectNews+='<option value="/tin-tuc/'+e.getTime()+'">'+t.title.tonal+"</option>"}),selectNews+="</select>"}),$(".tree").treegrid(),$(".date").inputmask("dd/mm/yyyy",{placeholder:"__/__/____"}),activeTab("tab-floor"),$("#tableRoomType").DataTable({responsive:!0,pageLength:50,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Vietnamese.json"}}),$("select[name='semester[year]']").change(function(){var t={year:$("select[name='semester[year]']").val()};$.post("/admin/semester/getNewSemesterValue",t,function(t){$("input[name='semester[value]']").val(t.value)})}),$("#categoriesTable").DataTable({responsive:!0,pageLength:50,language:{url:"//cdn.datatables.net/plug-ins/1.10.15/i18n/Vietnamese.json"}}),$(".newCatagories").click(function(){$(this);$.confirm({title:"TẠO CHUYÊN MỤC MỚI",content:'<form action=""  class="formName"><div class="form-group"><label>Bạn có chắc chắn muốn tạo chuyên mục mới ?</label><input type="text" placeholder="Tên chuyên mục" class="name form-control" required /></div></form>',buttons:{formSubmit:{text:"Có",btnClass:"btn-blue",action:function(){var t=this.$content.find(".name").val();if(!t)return $.alert("Vui lòng nhập tên chuyên mục"),!1;$.get("/admin/categories/create/"+t,function(t){if(1==t.status){$.alert("Tạo thư mục thành công");var e=t.index+1,n='<tr data-id="'+t.catagories[0]._id+'" role="row" class="odd"><td class="text-center sorting_1"> '+e+'</td><td class="text-center"><a href="'+t.catagories[0].id+'">'+t.catagories[0].name+'</a></td><td class="text-center">'+t.created+'</td><td class="text-center">0</td><td class="text-center">Chưa có bài đăng nào</td><td class="text-center"><a class="glyphicon glyphicon-star" onclick="changeCategoriesPublished(&quot;'+t.catagories[0].id+"&quot;,&quot;"+t.catagories[0]._id+'&quot;)"></a><a class="glyphicon glyphicon-pencil" style="margin-left : 5px;" onclick="changeCategoriesName(&quot;'+t.catagories[0]._id+"&quot; , &quot;"+t.catagories[0].id+"&quot; , &quot;"+t.catagories[0].name+'&quot;)"></a></td></tr>';$("#rowCatagories").append(n)}else $.alert("Tên thư mục đã tồn tại , vui lòng nhập tên khác !")})}},formCancel:{text:"Không"}},onContentReady:function(){var t=this;this.$content.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}})}),$("#linkedsite tbody").sortable({update:function(t,e){$("tbody > tr .counter").each(function(t){$(this).text(t+1)})}}),$(".newlinkedsite").click(function(){$.confirm({title:"TẠO LIÊN KẾT/QUẢNG CÁO MỚI",content:'<div class="form-group" id="create-link"><input type="text" placeholder="Nội dung liên kết" class="content form-control"/><input type="text" placeholder="Đường dẫn" class="link form-control"/><input class="hidden" name="file_linkedSite" type="file" accept="image/*" /><button id="photo_upload" class="btn btn-blue">Chọn Ảnh</button><img name="image_linkedSite" class="img-responsive" style="width: 300px; height: 200px; margin-top: 20px" src=""><input name="imageName" class="img form-control" type="hidden" value="" /></div>',buttons:{formSubmit:{text:"TẠO MỚI",btnClass:"btn-blue",action:function(){var t=this.$content.find(".content").val(),e=this.$content.find(".link").val(),n=this.$content.find(".img").val(),o={link:e,content:t,img:n};if(!n)return $.alert("Hãy chọn hình ảnh!"),!1;$.post("/admin/linkedSite/create",o,function(t){1==t.status?window.location="/admin/setup":$.alert("Tạo thất bại")})}},cancel:function(){}},onContentReady:function(){$("#photo_upload").click(function(){$("input[name='file_linkedSite']").click()}),$("input[name='file_linkedSite']").change(function(){var t=new FormData;t.append("file",$('input[name="file_linkedSite"]')[0].files[0]),$.ajax({url:"/admin/linkedSite/uploadImage",type:"POST",data:t,processData:!1,contentType:!1,success:function(t){1==t.status&&($("img[name='image_linkedSite']").attr("src","/document/image/"+t.document.name),$("input[name='imageName']").val(t.document.name))}})});var t=this;this.$content.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}})});var t=!1;$(".updateLinkedSite").click(function(){$.get("/admin/currentSemester",{},function(e){var n=e.config.linkedSite,o=new Array;$("#link-table tbody tr").each(function(t,e){var n=$(e),i=n.children().eq(1).children().eq(1).val(),a=n.children().eq(2).text(),l=n.children().eq(3).html(),c=n.children().eq(4).html(),r=!!n.children().eq(5).children().eq(0).children().eq(0).hasClass("glyphicon-star");o.push({img:i,link:a,content:l,created:parseDate(c),published:r})}),$.each(n,function(e,n){n.link==o[e].link&&n.content==o[e].content&&n.published==o[e].published||(t=!0)}),1==t?$.post("/admin/linkedSite/update",{data:o},function(t){1==t.status&&(window.location="/admin/setup")}):$.confirm({title:"Chưa có gì thay đổi",content:" ",buttons:{OK:function(){}}})})}),$(".newRoomType").click(function(){$(this);$.confirm({title:"TẠO LOẠI PHÒNG MỚI",content:'<form action=""  class="formName"><div class="form-group"><label>Bạn có chắc chắn muốn tạo loại phòng mới ?</label><input type="text" placeholder="Tên loại phòng" class="name form-control" required /></div></form>',buttons:{formSubmit:{text:"Có",btnClass:"btn-blue",action:function(){var t=this.$content.find(".name").val();if(!t)return $.alert("Vui lòng nhập tên loại phòng"),!1;$.get("/admin/roomType/create/"+t,function(t){if(1==t.status){var e=t.index+1;$.alert("Tạo loại phòng thành công");var n='<tr data-id="'+t.roomType[0]._id+'"><td class="text-center">'+e+'</td><td class="text-center">'+t.roomType[0].name+'</td><td class="text-center">'+t.created+'</td><td class="text-center"><a href="#" onclick="showRoom(&quot;'+t.roomType[0]._id+"&quot;,&quot;"+t.roomType[0].name+'&quot;)">0</a></td><td class="text-center"><a class="glyphicon glyphicon-star" onclick="changePublishedRoomType(&quot;'+t.roomType[0]._id+'&quot;)"></a><a class="glyphicon glyphicon-pencil" style="margin-left : 5px;" onclick="changeNameRoomType(&quot;'+t.roomType[0]._id+"&quot; , &quot;"+t.roomType[0].name+'&quot;)"></a></td></tr>';$("#rowRoomType").append(n)}else $.alert("Lọai phòng đã tồn tại , vui lòng nhập tên khác !")})}},formCancel:{text:"Không"}},onContentReady:function(){var t=this;this.$content.find("form").on("submit",function(e){e.preventDefault(),t.$$formSubmit.trigger("click")})}})})}),$("button[name='addFloor']").click(function(){$("#formAction").empty();var t='<div class="col-sm-8 col-sm-push-2  border-all"><form action="/admin/setup/addFloor" method="post" onsubmit="return validateAddFloor()"><h5 style="text-align: center">Thêm tầng</h5><div class="form-group"><label>Tên tầng </label><input type="text" name="floorName" required></div><div class="form-group align-center"><input class="btn btn-primary form-control" type="submit" value="Thêm"></div><input class="hidden" name="id" value='+JSON.parse($('input[name="currentConfig"]').val())._id+"></form></div>";$("#formAction").append(t),$("select").selectpicker()}),$("button[name='removeFloor']").click(function(){$("#formAction").empty();var t=JSON.parse($('input[name="currentConfig"]').val()),e=t.floor;if(0==e.length)alert("Chưa có tầng nào trong hệ thống");else{var n='<div class="col-sm-8 col-sm-push-2  border-all"><form action="/admin/setup/removeFloor" method="post"><h5 style="text-align: center">Xoá tầng</h5><div class="form-group"><label>Chọn tầng</label><select class="form-control" name="floors">';e.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+="<option value="+t._id+"> TẦNG "+t.name+"</option>"});n+='</select></div><div class="form-group align-center"><input class="btn btn-primary form-control" type="submit" value="Xoá"></div><input class="hidden" name="configId" value='+t._id+"></form></div>"}$("#formAction").append(n),$("select").selectpicker()}),$('button[name="addRoom"]').click(function(){$("#formAction").empty();var t=JSON.parse($('input[name="currentConfig"]').val()),e=t.floor;if(0==e.length)alert("Chưa có tầng nào trong hệ thống");else{var n='<div class="col-sm-8 col-sm-push-2  border-all"><form action="/admin/setup/addRoom" method="post" onsubmit="return validateAddRoom()"><h5 style="text-align: center">Thêm phòng</h5><div class="form-group"><label>Chọn tầng</label><select class="form-control" name="floors">';e.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'">TẦNG '+t.name+"</option>"});n+='</select></div><div class="form-group"><label>Tên Phòng </label><input type="text" name="roomName"/></div><div class="form-group"><label>Loại phòng </label><select class="form-control" name="roomType"  >',t.roomType.map(function(t){n+='<option value="'+t._id+'">'+t.name+"</option>"}),n+='</select></div><div class="form-group align-center"><input class="btn btn-primary form-control" type="submit" value="Thêm"></div><input class="hidden" name="id" value='+t._id+"></form></div>"}$("#formAction").append(n),$("select").selectpicker()}),$('button[name="removeRoom"]').click(function(){$("#formAction").empty();var t=JSON.parse($('input[name="currentConfig"]').val()),e=t.floor;if(0==e.length)alert("Chưa có tầng nào trong hệ thống");else{var n='<div class="col-sm-8 col-sm-push-2  border-all"><form action="/admin/setup/removeRoom" method="post" onsubmit="return validateRemoveRoom()"><h5 style="text-align: center">Xoá phòng</h5><div class="form-group"><label>Chọn tầng</label><select class="form-control" name="floors" onchange="optionOfSelectRoom(this)">';e.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'" >TẦNG '+t.name+"</option>"});if(n+='</select></div><div class="form-group"><label>Chọn phòng</label><div id="selectRoom"><select class="form-control" name="rooms"  >',0==e[0].roomList.length)n+='<option value=""></option>';else e[0].roomList.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'">PHÒNG '+t.name+"</option>"});n+='</select></div></div<div class="form-group align-center"><input class="btn btn-primary form-control" type="submit" value="Xoá"/></div><input class="hidden" name="configId" value='+t._id+"></form></div>"}$("#formAction").append(n),$("select").selectpicker()}),$('button[name="addBed"]').click(function(){$("#formAction").empty();var t=JSON.parse($('input[name="currentConfig"]').val()),e=t.floor;if(0==e.length)alert("Chưa có tầng nào trong hệ thống");else{var n='<div class="col-sm-8 col-sm-push-2  border-all"><form action="/admin/setup/addBed" method="post" onsubmit="return validateAddBed()"><h5 style="text-align: center">Thêm giường</h5><div class="form-group"><label>Chọn tầng</label><select class="form-control" name="floors" onchange="optionOfSelectRoom(this)">';e.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'" >TẦNG '+t.name+"</option>"});n+='</select></div><div class="form-group"><label>Chọn phòng</label><div id="selectRoom"><select class="form-control" name="rooms"  >';e[0].roomList.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'">PHÒNG '+t.name+"</option>"});n+='</select></div></div<div class="form-group"><label>Tên giường </label><input type="text" name="bedName"></div><div class="form-group align-center"><input class="btn btn-primary form-control" type="submit" value="Thêm"></div><input class="hidden" name="id" value='+t._id+"></form></div>"}$("#formAction").append(n),$("select").selectpicker()}),$('button[name="removeBed"]').click(function(){$("#formAction").empty();var t=JSON.parse($('input[name="currentConfig"]').val()),e=t.floor;if(0==e.length)alert("Chưa có tầng nào trong hệ thống");else{var n='<div class="col-sm-8 col-sm-push-2  border-all"><form action="/admin/setup/removeBed" method="post" onsubmit="return validateRemoveBed()"><h5 style="text-align: center">Xoá giường</h5><div class="form-group"><label>Chọn tầng</label><select class="form-control" name="floors" onchange="optionOfSelectRoom2(this)">';e.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'" >TẦNG '+t.name+"</option>"});if(n+='</select></div><div class="form-group"><label>Chọn phòng</label><div id="selectRoom"><select class="form-control" name="rooms" onchange="optionOfSelectBed(this)" >',e[0].roomList.length>0){e[0].roomList.sort(function(t,e){var n=Number(t.name),o=number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'">PHÒNG '+t.name+"</option>"});if(n+='</select></div></div<div class="form-group"><label>Chọn giường</label><div id="selectBed"<select class="form-control" name="beds" ">',0==e[0].roomList[0].bed.length)n+='<option value=""></option></select></div></div>';else{e[0].roomList[0].bed.sort(function(t,e){var n=Number(t.name),o=Number(e.name);return n<o?-1:n>o?1:0}).map(function(t){n+='<option value="'+t._id+'">GIƯỜNG '+t.name+"</option>"});n+="</select></div></div>"}}else n+='<option value=""></option>',n+='</select></div></div<div class="form-group"><label>Chọn giường</label><div id="selectBed"<select class="form-control" name="beds" "><option value=""></option></select></div></div>';n+='<div class="form-group align-center"><input class="btn btn-primary form-control" type="submit" value="Xoá"></div><input class="hidden" name="configId" value='+t._id+"></form></div>"}$("#formAction").append(n),$("select").selectpicker()});